---
import Layout from '~/layouts/PageLayout.astro';
import HeroText from '~/components/widgets/HeroText.astro';
import ContactUs from '~/components/widgets/Contact.astro';
import Features2 from '~/components/widgets/Features2.astro';
import { supabase } from '../lib/supabase';

export const prerender = false;

const metadata = {
  title: 'Contact',
};

const handleSubmit = async (event) => {
  event.preventDefault();

  console.log('Form submitted!');
  const formData = new FormData(event.target);

  const data = Object.fromEntries(formData.entries());

  try {
    const { error } = await supabase
      .from('contacts') // Your Supabase table name
      .insert([data]);

    if (error) {
      console.error('Error saving data to Supabase:', error.message);
      alert('There was an issue submitting your form. Please try again.');
    } else {
      alert('Form submitted successfully!');
      event.target.reset();
    }
  } catch (err) {
    console.error('Unexpected error:', err);
    alert('An unexpected error occurred. Please try again.');
  }
};

const submit = () => {
  console.log('Form submitted!');
};
---

<Layout metadata={metadata}>
  <!-- HeroText Widget ******************* -->

  <HeroText tagline="Contact" title="Let's Connect!" />

  <ContactUs
    title="Drop us a message today!"
    subtitle="For quicker answers, explore our FAQs section. You may find the solution you're looking  for right there! If not, our support team is delighted to help you."
    inputs={[
      {
        type: 'text',
        name: 'name',
        label: 'Name',
      },
      {
        type: 'email',
        name: 'email',
        label: 'Email',
      },
    ]}
    textarea={{
      label: 'Message',
    }}
    disclaimer={{
      label:
        'By submitting this contact form, you acknowledge and agree to the collection of your personal information.',
    }}
    description="Our team typically responds within 24 business hours."
    onClick={handleSubmit}
  />

  <!-- Features2 Widget ************** -->

  <Features2
    title="We are here to help!"
    columns={2}
    items={[
      {
        title: 'General support',
        description: `Reach out for assistance with event planning, troubleshooting booking or payment issues, navigating our services, or general questions about our laser and light show offerings.`,
      },
      {
        title: 'Contact sales',
        description:
          'Get in touch for inquiries about booking laser shows, customizing event packages, pricing for commercial productions, or licensing our effects for your concerts or events.',
      },
      {
        title: 'Phone',
        description: '+1 (720) 955-8929',
        icon: 'tabler:headset',
      },
      {
        title: 'Email',
        description: 'hotbeamproductions@gmail.com',
        icon: 'tabler:mail',
      },
    ]}
  />
</Layout>
